{% extends "base.html" %}
{% load upper from currency_filter %}
{% load breadcrumb from navigation %}
{% load vertical_menu from navigation %}
{% load vertical_filters from navigation %}



{% block content %}
  <section class="header">
    {% block breadcrumbs %}
      {% breadcrumb path=breadcrumbPath token=currentCategory %}
    {% endblock %}
  </section>
  <div class="container">
    <div class="row">
      <div class="products-grid col-xl-9 col-lg-8 order-lg-2">
        <div class="row">

          {% for product in products %}
            <div class="col-xl-4 col-sm-6">
              <div class="product">
                <div class="product-image">
                  <img src="/media/{{ product.productimage__product_photo }}"
                       alt="product" class="img-fluid">
                  <div class="product-hover-overlay">
                    <a rel="canonical" href="/product/{{ product.product_id }}" class="product-hover-overlay-link"></a>
                    <div class="product-hover-overlay-buttons">
                      <a href="#" class="btn btn-outline-dark btn-product-left"><i
                              class="fa fa-shopping-cart"></i>
                      </a>
                      <a rel="canonical" href="/product/{{ product.product_id }}" class="btn btn-color btn-buy">
                        <i class="fa-search fa"></i>
                        <span class="btn-buy-label ml-2">Глянути</span>
                      </a>
                    </div>
                  </div>
                </div>
                <div class="py-2">
                  <h1 class="h6 text-uppercase mb-1">
                    <a rel="canonical" href="/product/{{ product.product_id }}" class="text-dark">{{ product.product_name }}</a>
                  </h1>
                  <span class="price">{{ product.product_price }} </span>
                  <span class="price">{{ product.product_currency | lower }}</span>
                </div>
              </div>
            </div>
          {% endfor %}

        </div>
        <nav aria-label="page navigation" class="d-flex justify-content-center mb-5 mt-3">
          <ul class="pagination">
            {#        TODO implement request.get_full_path#}
            {#        TODO move this block to the tag#}

            <li class="page-item">
              <a href="{% if products.has_previous %}?page={{ products.previous_page_number }}{% endif %}"
                 aria-label="Previous"
                 class="page-link  {% if not products.has_previous %}disabled{% endif %}">
                <span aria-hidden="true">Prev</span>
                <span class="sr-only">Previous</span>
              </a>
            </li>

            {% for page_number in page_range %}
              {% if products.number == page_number %}
                <li class="page-item active">
                  <a href="?page={{ page_number }}" class="page-link">{{ page_number }}</a>
                </li>
              {% else %}
                <li class="page-item">
                  <a href="?page={{ page_number }}" class="page-link">{{ page_number }}</a>
                </li>
              {% endif %}
            {% endfor %}

            <li class="page-item">
              <a href="{% if products.has_next %}?page={{ products.next_page_number }}{% endif %}" aria-label="Next"
                 class="page-link {% if not products.has_next %}disabled{% endif %}">
                <span aria-hidden="true">Next</span>
                <span class="sr-only">Next</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>

      {#    SIDEBAR  #}

      <div class="sidebar col-md-auto">

        {% vertical_menu items=verticalCategoriesTree current_category=currentCategory %}

        {% vertical_filters items=filters current_category=currentCategory restricted=restricted%}

      </div>
    </div>
  </div>
{% endblock content %}
